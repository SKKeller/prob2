<?xml version="1.0" encoding="UTF-8"?>
<?eclipse version="3.4"?>
<plugin>
   <extension
         point="org.eclipse.ui.menus">
          <menuContribution
            locationURI="menu:debug">
      </menuContribution>
      
        <menuContribution
            locationURI="popup:fr.systerel.explorer.navigator.view">
         <separator
               name="de.prob.ui.separator2"
               visible="true">
         </separator>
         <command
               commandId="de.prob.ui.starteventbanimation"
               icon="icons/prob.png"
               label="Start Animation / Model Checking"
               style="push">
            <visibleWhen>
      <with
            variable="selection">
         <iterate
               operator="or">
            <instanceof
                  value="org.eventb.core.IEventBRoot">
            </instanceof>
         </iterate>
      </with>
            </visibleWhen>
         </command>
         <separator
               name="de.prob.ui.separator1"
               visible="true">
         </separator>
      </menuContribution>
        <menuContribution
              locationURI="toolbar:de.prob.ui.OperationView">
           <command
                 commandId="de.prob.ui.randomoperation"
                 icon="icons/resume.gif"
                 label="Execute Random Operations"
                 style="pulldown">
           </command>
           <command
                 commandId="de.prob.ui.history.restartAnim"
                 icon="icons/refresh.gif"
                 label="Restart Animation"
                 style="push">
           </command>
           <command
                 commandId="de.prob.ui.history.back"
                 icon="icons/back.gif"
                 label="History Back"
                 style="push">
           </command>
           <command
                 commandId="de.prob.ui.history.forward"
                 icon="icons/forward.gif"
                 label="History Forward"
                 style="push">
           </command>
        </menuContribution>
        <menuContribution
              locationURI="menu:de.prob.ui.randomoperation">
           <command
                 commandId="de.prob.ui.randomoperation"
                 label="Execute 1 Step"
                 style="push">
              <parameter
                    name="de.prob.ui.randomoperation.steps"
                    value="1">
              </parameter>
           </command>
           <command
                 commandId="de.prob.ui.randomoperation"
                 label="Execute 5 Steps"
                 style="push">
              <parameter
                    name="de.prob.ui.randomoperation.steps"
                    value="5">
              </parameter>
           </command>
           <command
                 commandId="de.prob.ui.randomoperation"
                 label="Execute 10 Steps"
                 style="push">
              <parameter
                    name="de.prob.ui.randomoperation.steps"
                    value="10">
              </parameter>
           </command>
           <command
                 commandId="de.prob.ui.randomoperation"
                 label="Enter Number of Steps"
                 style="push">
              <parameter
                    name="de.prob.ui.randomoperation.steps"
                    value="-1">
              </parameter>
           </command>
        </menuContribution>
        <menuContribution
              allPopups="false"
              locationURI="toolbar:de.prob.ui.groovy-console">
           <command
                 commandId="de.prob.ui.switch_loglevel"
                 icon="icons/verbose.png"
                 label="Switch Loglevel"
                 style="toggle">
           </command>
        </menuContribution>
      
   </extension>
   
   <extension
         point="org.eclipse.ui.commands">
      
            <command
            id="de.prob.ui.starteventbanimation"
            name="Event-B Animate / Model Check">
      </command>
            <command
                  id="de.prob.ui.history.back"
                  name="History Back">
            </command>
            <command
                  id="de.prob.ui.history.forward"
                  name="History Forward">
            </command>
            <command
                  id="de.prob.ui.history.restartAnim"
                  name="Restart Animation">
            </command>
            <command
                  id="de.prob.ui.randomoperation"
                  name="Execute Random Events">
               <commandParameter
                     id="de.prob.ui.randomoperation.steps"
                     name="Number of Steps"
                     optional="false">
               </commandParameter>
            </command>
            <command
                  id="de.prob.ui.switch_loglevel"
                  name="Switch Loglevel">
               <state
                     class="de.prob.ui.console.LogLevelHandler$NonPersistingToggleState"
                     id="org.eclipse.ui.commands.toggleState">
               </state>
            </command>
      
   </extension>
   
   <extension
         point="org.eclipse.ui.handlers">
      
      <handler
            commandId="de.prob.ui.starteventbanimation">
         <class
               class="de.prob.ui.eventb.StartAnimationHandler">
         </class>
                     <enabledWhen>
      <with
            variable="selection">
         <iterate
               operator="or">
               <or>
            <instanceof
                  value="org.eventb.core.IEventBRoot">
            </instanceof>
            <and>
                 <instanceof
                       value="org.eclipse.core.resources.IResource">
                 </instanceof>
                 <or>
                 <test
                       forcePluginActivation="true"
                       property="org.eclipse.core.resources.extension"
                       value="bum">
                 </test>
                 <test
                       forcePluginActivation="true"
                       property="org.eclipse.core.resources.extension"
                       value="buc">
                 </test>
                 </or>
              </and>
              </or>
         </iterate>
      </with>
            </enabledWhen>
      </handler>
      <handler
            commandId="de.prob.ui.history.back">
         <class
               class="de.prob.ui.operationview.HistoryBackHandler">
         </class>
         <enabledWhen>
            <and>
               <with
                     variable="de.prob.ui.model_loaded">
                  <equals
                        value="enabled">
                  </equals>
               </with>
               <with
                     variable="de.prob.ui.history.backward_service">
                  <equals
                        value="enabled">
                  </equals>
               </with>
            </and>
         </enabledWhen>
      </handler>
      <handler
            commandId="de.prob.ui.history.forward">
         <class
               class="de.prob.ui.operationview.HistoryForwardHandler">
         </class>
         <enabledWhen>
            <and>
               <with
                     variable="de.prob.ui.model_loaded">
                  <equals
                        value="enabled">
                  </equals>
               </with>
               <with
                     variable="de.prob.ui.history.forward_service">
                  <equals
                        value="enabled">
                  </equals>
               </with>
            </and>
         </enabledWhen>
      </handler>
      <handler
            commandId="de.prob.ui.history.restartAnim">
         <class
               class="de.prob.ui.operationview.RestartAnimationHandler">
         </class>
         <enabledWhen>
            <with
                  variable="de.prob.ui.model_loaded">
               <equals
                     value="enabled">
               </equals>
            </with>
         </enabledWhen>
      </handler>
      <handler
            commandId="de.prob.ui.randomoperation">
         <enabledWhen>
            <with
                  variable="de.prob.ui.model_loaded">
               <equals
                     value="enabled">
               </equals>
            </with>
         </enabledWhen>
         <class
               class="de.prob.ui.operationview.ExecuteRandomHandler">
         </class>
      </handler>
      <handler
            commandId="de.prob.ui.switch_loglevel">
         <class
               class="de.prob.ui.console.LogLevelHandler">
         </class>
      </handler>
      
   </extension>
   <extension
         point="org.eclipse.ui.views">
      <category
            id="de.hhu.stups.prob"
            name="ProB">
      </category>
      <view
            category="de.hhu.stups.prob"
            class="de.prob.ui.operationview.OperationView"
            icon="icons/sample.gif"
            id="de.prob.ui.OperationView"
            name="Events">
      </view>
      <view
            category="de.hhu.stups.prob"
            class="de.prob.ui.stateview.StateView"
            icon="icons/sample.gif"
            id="de.prob.ui.StateView"
            name="State View">
      </view>
      <view
            category="de.hhu.stups.prob"
            class="de.prob.ui.historyview.HistoryView"
            icon="icons/sample.gif"
            id="de.prob.ui.HistoryView"
            name="History">
      </view>
      <view
            category="de.hhu.stups.prob"
            class="de.prob.ui.animationsview.AnimationsView"
            icon="icons/sample.gif"
            id="de.prob.ui.AnimationsView"
            name="Current Animations">
      </view>
      <view
            allowMultiple="false"
            category="de.hhu.stups.prob"
            class="de.prob.ui.console.GroovyConsole"
            id="de.prob.ui.groovy-console"
            name="Groovy Console"
            restorable="true">
      </view>
   </extension>
   <extension
         point="org.eclipse.ui.perspectiveExtensions">
      <perspectiveExtension
            targetID="org.eclipse.jdt.ui.JavaPerspective">
         <view
               id="de.prob.ui.operationview.OperationView"
               ratio="0.5"
               relationship="right"
               relative="org.eclipse.ui.views.ProblemView">
         </view>
         <view
               id="de.prob.ui.historyview.HistoryView"
               minimized="false"
               relationship="stack">
         </view>
         <view
               id="de.prob.ui.stateview"
               minimized="false"
               relationship="stack">
         </view>
      </perspectiveExtension>
   </extension>
   <extension
         point="org.eclipse.help.contexts">
      <contexts
            file="contexts.xml">
      </contexts>
   </extension>
   <extension
         point="org.eclipse.ui.services">
      <sourceProvider
            provider="de.prob.ui.services.HistoryActiveProvider">
         <variable
               name="de.prob.ui.history.forward_service"
               priorityLevel="workbench">
         </variable>
         <variable
               name="de.prob.ui.history.backward_service"
               priorityLevel="workbench">
         </variable>
      </sourceProvider>
      <sourceProvider
            provider="de.prob.ui.services.ModelLoadedProvider">
         <variable
               name="de.prob.ui.model_loaded"
               priorityLevel="workbench">
         </variable>
      </sourceProvider>
   </extension>

</plugin>
